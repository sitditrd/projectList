(function(){return function(path){var obj;this.registerScript(path,function(){this.rMateChartCurrentChartObj;this.rMateChartChartIDArr=new Array();this.rMateChartScriptURLArr=new Array();this.rMateChartChartVarsArr=new Array();this.rMateChartLastInvokeID=new Array();this.rMateChartCreate=function(chartObj,sURL,hURL,cVars){if(!this.rMateChartChartIDArr){this.rMateChartChartIDArr=new Array();}if(!this.rMateChartScriptURLArr){this.rMateChartScriptURLArr=new Array();}if(!this.rMateChartChartVarsArr){this.rMateChartChartVarsArr=new Array();}if(!this.rMateChartLastInvokeID){this.rMateChartLastInvokeID=new Array();}this.rMateChartChartIDArr.push(chartObj.name);this.rMateChartScriptURLArr.push(sURL);this.rMateChartChartVarsArr[this.rMateChartChartVarsArr.length]=cVars;this.rMateChartLastInvokeID.push("");chartObj.addEventHandler("onloadcompleted",this.rMateChart_DocumentComplete);chartObj.addEventHandler("onusernotify",this.rMateChart_UserNotify);chartObj.set_url(hURL);};this.rMateChartClear=function(chartObj){if(chartObj==null){return;}chartObj.removeEventHandler("onloadcompleted",this.rMateChart_DocumentComplete);chartObj.removeEventHandler("onusernotify",this.rMateChart_UserNotify);chartObj.destroy();chartObj=null;};this.rMateChartSetTheme=function(chartObj,x){if(chartObj._ifrm_elem._plugin_object){var doc=chartObj.getProperty("Document").getProperty("parentWindow");doc.callMethod("rMateChartSetTheme",x);}else{chartObj._ifrm_elem._window.rMateChartSetTheme(x);}};this.rMateChartSetLayout=function(chartObj,x){if(chartObj._ifrm_elem._plugin_object){var doc=chartObj.getProperty("Document").getProperty("parentWindow");doc.callMethod("rMateChartSetLayout",x);}else{chartObj._ifrm_elem._window.rMateChartSetLayout(x);}};this.rMateChartSetLayoutURL=function(chartObj,u){if(chartObj._ifrm_elem._plugin_object){var doc=chartObj.getProperty("Document").getProperty("parentWindow");doc.callMethod("rMateChartSetLayoutURL",u);}else{chartObj._ifrm_elem._window.rMateChartSetLayoutURL(u);}};this.rMateChartSetSlideLayoutSet=function(chartObj,x){if(chartObj._ifrm_elem._plugin_object){var doc=chartObj.getProperty("Document").getProperty("parentWindow");if(typeof (x)=="string"){doc.callMethod("rMateChartSetSlideLayoutSet",x);}else{var xstr="[";for(var i=0;i<x.length;i++ ){if(typeof (x[i])=="object"){xstr+="{";var pstr="";for(var propName in x[i]){if(pstr!=""){pstr+=",";}pstr+=propName+":";if(typeof (x[i][propName])=="string"){pstr+=this.rMateChartEncodeParamStr(x[i][propName]);}else{pstr+=x[i][propName];}}xstr+=pstr+"}";}else{xstr+=this.rMateChartEncodeParamStr(x[i].toString());}if(i<x.length-1){xstr+=",";}}xstr+="]";doc.callMethod("rMateChartSetSlideLayoutSet",xstr);}}else{chartObj._ifrm_elem._window.rMateChartSetSlideLayoutSet(x);}};this.rMateChartSetData=function(chartObj,d){if(chartObj._ifrm_elem._plugin_object){var doc=chartObj.getProperty("Document").getProperty("parentWindow");if(typeof (d)=="string"){doc.callMethod("rMateChartSetData",d);}else{var xstr="[";for(var i=0;i<d.length;i++ ){if(typeof (d[i])=="object"){xstr+="{";var pstr="";for(var propName in d[i]){if(pstr!=""){pstr+=",";}pstr+=propName+":";if(typeof (d[i][propName])=="string"){pstr+=this.rMateChartEncodeParamStr(d[i][propName]);}else{pstr+=d[i][propName];}}xstr+=pstr+"}";}else{xstr+=this.rMateChartEncodeParamStr(d[i].toString());}if(i<d.length-1){xstr+=",";}}xstr+="]";doc.callMethod("rMateChartSetData",xstr);}}else{chartObj._ifrm_elem._window.rMateChartSetData(d);}};this.rMateChartSetDataURL=function(chartObj,u){if(chartObj._ifrm_elem._plugin_object){var doc=chartObj.getProperty("Document").getProperty("parentWindow");doc.callMethod("rMateChartSetDataURL",u);}else{chartObj._ifrm_elem._window.rMateChartSetDataURL(u);}};this.rMateChartSetSlideDataSet=function(chartObj,d){if(chartObj._ifrm_elem._plugin_object){var doc=chartObj.getProperty("Document").getProperty("parentWindow");if(typeof (d)=="string"){doc.callMethod("rMateChartSetSlideDataSet",d);}else{var xstr=this.rMateChartEncodeJavaScriptObj(d);doc.callMethod("rMateChartSetSlideDataSet",xstr);}}else{chartObj._ifrm_elem._window.rMateChartSetSlideDataSet(d);}};this.rMateChartGetSnapshot=function(chartObj){if(chartObj._ifrm_elem._plugin_object){var doc=chartObj.getProperty("Document").getProperty("parentWindow");doc.callMethod("rMateChartGetSnapshot");var objHtmlElementCollection=chartObj.document.getElementById("invokeData");return objHtmlElementCollection.value;}else{return chartObj._ifrm_elem._window.rMateChartGetSnapshot();}};this.rMateChartSaveAsImage=function(chartObj){if(chartObj._ifrm_elem._plugin_object){var doc=chartObj.getProperty("Document").getProperty("parentWindow");doc.callMethod("rMateChartSaveAsImage");}else{chartObj._ifrm_elem._window.rMateChartSaveAsImage();}};this.rMateChartLegendAllCheck=function(chartObj,b){if(chartObj._ifrm_elem._plugin_object){var doc=chartObj.getProperty("Document").getProperty("parentWindow");doc.callMethod("rMateChartLegendAllCheck",b);}else{chartObj._ifrm_elem._window.rMateChartLegendAllCheck(b);}};this.rMateChartShowAdditionalPreloader=function(chartObj){if(chartObj._ifrm_elem._plugin_object){var doc=chartObj.getProperty("Document").getProperty("parentWindow");doc.callMethod("rMateChartShowAdditionalPreloader");}else{chartObj._ifrm_elem._window.rMateChartShowAdditionalPreloader();}};this.rMateChartRemoveAdditionalPreloader=function(chartObj){if(chartObj._ifrm_elem._plugin_object){var doc=chartObj.getProperty("Document").getProperty("parentWindow");doc.callMethod("rMateChartRemoveAdditionalPreloader");}else{chartObj._ifrm_elem._window.rMateChartRemoveAdditionalPreloader();}};this.rMateChartShowDataEditor=function(chartObj){if(chartObj._ifrm_elem._plugin_object){var doc=chartObj.getProperty("Document").getProperty("parentWindow");doc.callMethod("rMateChartShowDataEditor");}else{chartObj._ifrm_elem._window.rMateChartShowDataEditor();}};this.rMateChartRemoveDataEditor=function(chartObj){if(chartObj._ifrm_elem._plugin_object){var doc=chartObj.getProperty("Document").getProperty("parentWindow");doc.callMethod("rMateChartRemoveDataEditor");}else{chartObj._ifrm_elem._window.rMateChartRemoveDataEditor();}};this.rMateChartGetChartData=function(chartObj){if(chartObj._ifrm_elem._plugin_object){var doc=chartObj.getProperty("Document").getProperty("parentWindow");return doc.callMethod("rMateChartGetChartData");}else{return chartObj._ifrm_elem._window.rMateChartGetChartData();}};this.rMateChartHasNoData=function(chartObj,b){if(chartObj._ifrm_elem._plugin_object){var doc=chartObj.getProperty("Document").getProperty("parentWindow");doc.callMethod("rMateChartHasNoData",b);}else{chartObj._ifrm_elem._window.rMateChartHasNoData(b);}};this.rMateChartDownloadlToLocal=function(chartObj,n,t,u){if(chartObj._ifrm_elem._plugin_object){var doc=chartObj.getProperty("Document").getProperty("parentWindow");doc.callMethod("rMateChartDownloadlToLocal",n,t,u);}else{chartObj._ifrm_elem._window.rMateChartDownloadlToLocal(n,t,u);}};this.rMateChartEncodeParamStr=function(str){if(str==null){return "null";}var ret="'";var rgExp1=/'/g;var rgExp2=/\n/g;ret+=str.replace(rgExp1,"\\'").replace(rgExp2,"");ret+="'";return ret;};this.rMateChartEncodeJavaScriptObj=function(obj){switch(typeof (obj)){case "number":return obj.toString();case "boolean":return obj.toString();case "string":return this.rMateChartEncodeParamStr(obj);case "null":return "null";case "undefined":return "undefined";case "object":var xstr="";if(obj.length){xstr="[";for(var i=0;i<obj.length;i++ ){if(i>0){xstr+=",";}xstr+=this.rMateChartEncodeJavaScriptObj(obj[i]);}xstr+="]";}else{xstr+="{";var pstr="";for(var propName in obj){if(pstr!=""){pstr+=",";}pstr+=propName+":";pstr+=this.rMateChartEncodeJavaScriptObj(obj[propName]);}xstr+=pstr+"}";}return xstr;default:trace("rMateChartEncodeXML unknown type:"+typeof (obj));return "undefined";}return "undefined";};this.rMateChartFindChartIDArr=function(id){if(id==null){return  -1;}for(var i=0;i<this.rMateChartChartIDArr.length;i++ ){if(id==this.rMateChartChartIDArr[i]){return i;}}return  -1;};this.rMateChart_DocumentComplete=function(obj,e){var p;if(obj["rMateChartCreate"]){p=obj;}else{p=obj;if(p["parent"]&&p["parent"]["rMateChartCreate"]){p=p.parent;}else{if(p["parent"]["parent"]&&p["parent"]["parent"]["rMateChartCreate"]){p=p.parent.parent;}else{if(p["parent"]["parent"]["parent"]&&p["parent"]["parent"]["parent"]["rMateChartCreate"]){p=p.parent.parent.parent;}}}}if(!p){trace("rMateChart_UserNotify Can't find parent Form:"+obj.name);return;}var chrarIdx=p.rMateChartFindChartIDArr.call(p,obj.name);if(chrarIdx<0){trace("rMateChart_DocumentComplete Can't find chart id:"+obj.name);return;}if(obj._ifrm_elem._plugin_object){var doc=obj.getProperty("Document").getProperty("parentWindow");doc.callMethod("rMateChartSetLicense",p.rMateChartH5License);doc.callMethod("rMateChartCreate",obj.name,p.rMateChartScriptURLArr[chrarIdx],p.rMateChartChartVarsArr[chrarIdx],"100%","100%","#FFFFFF");}else{obj._ifrm_elem._window.rMateChartSetLicense(p.rMateChartH5License);obj._ifrm_elem._window.rMateChartCreate(obj.name,p.rMateChartScriptURLArr[chrarIdx],p.rMateChartChartVarsArr[chrarIdx],'100%','100%','#FFFFFF');}};this.rMateChart_UserNotify=function(obj,e){var p;if(obj["rMateChartCreate"]){p=obj;}else{p=obj;if(p["parent"]&&p["parent"]["rMateChartCreate"]){p=p.parent;}else{if(p["parent"]["parent"]&&p["parent"]["parent"]["rMateChartCreate"]){p=p.parent.parent;}else{if(p["parent"]["parent"]["parent"]&&p["parent"]["parent"]["parent"]["rMateChartCreate"]){p=p.parent.parent.parent;}}}}if(!p){trace("rMateChart_UserNotify Can't find parent Form:"+obj.name);return;}p.rMateChartCurrentChartObj=obj;var req=e.userdata;if(req.indexOf("invoked")!=0){return;}var chrarIdx=p.rMateChartFindChartIDArr.call(p,obj.name);if(chrarIdx<0){trace("rMateChart_UserNotify Can't find chart id:"+obj.name);return;}if(req==p.rMateChartLastInvokeID[chrarIdx]){return;}p.rMateChartLastInvokeID[chrarIdx]=req;if(obj._ifrm_elem._plugin_object){var objDocument=obj.getProperty("Document").getProperty("parentWindow");var objHtmlElementCollection=objDocument.getProperty("invokeData");req=objHtmlElementCollection;}else{var objDocument=obj.document;var objHtmlElementCollection=objDocument.getElementById("invokeData");req=objHtmlElementCollection.value;}var ret;var hr;if(req==null){return;}if(req.indexOf("<")!=0){return;}var xmlDoc,xmlParser;var invoke,invokeName;var args,argArr;if(objDocument){xmlParser=new DomParser;xmlParser.onParseError=p.rMateChartParseErrorHandler;xmlDoc=xmlParser.parseFromString(req,"text/xml");invoke=xmlDoc.getElementsByTagName("invoke");if(invoke.length>0){invokeName=invoke[0].getAttribute("name");}args=xmlDoc.getElementsByTagName("arguments");if(args.length>0&&args[0].childNodes&&args[0].childNodes.length>0){argArr=[];for(i=0;i<args[0].childNodes.length;i++ ){if(args[0].childNodes[i]){var arg=p.rMateChartParseArgNode.call(p,args[0].childNodes[i]);argArr[i]=arg;}}}}else{if(eval("window.DOMParser")){xmlParser=eval("new DOMParser()");xmlDoc=xmlParser.parseFromString(req,"text/xml");}else{xmlDoc=eval("new ActiveXObject('Microsoft.XMLDOM')");eval("xmlDoc.async = false;");xmlDoc.loadXML(req);if(xmlDoc.parseError.errorCode!=0){trace("rMateChart_UserNotify Parse Error: "+xmlDoc.parseError.reason+" (line: "+xmlDoc.parseError.line+", linepos: "+xmlDoc.parseError.linepos+")");xmlDoc=null;return;}}invoke=xmlDoc.getElementsByTagName("invoke");if(invoke.length>0){invokeName=invoke[0].getAttribute("name");}args=xmlDoc.getElementsByTagName("arguments");if(args.length>0&&args[0].childNodes&&args[0].childNodes.length>0){argArr=[];for(i=0;i<args[0].childNodes.length;i++ ){if(args[0].childNodes[i]){var arg=p.rMateChartParseArgNode.call(p,args[0].childNodes[i]);argArr[i]=arg;}}}}if(typeof (p[invokeName])=="function"){var func=p[invokeName];if(argArr&&argArr.length>0){ret=func.apply(p,argArr);}else{ret=func.apply(p);}hr=0;}else{trace("rMateChart_UserNotify error : invalid invoke name "+invokeName);}xmlParser=null;xmlDoc=null;return hr;};this.rMateChartEncodeXML=function(value){var xstr;switch(typeof (value)){case "number":return "<number>"+value+"</number>";case "string":return "<string><"+"![CDATA["+value+"]]"+"></string>";case "null":return "<null/>";case "undefined":return "<undefined/>";case "boolean":if(value){return "<true/>";}else{return "<false/>";}case "object":if(value.length){xstr="<array>";for(var iii=0;iii<value.length;iii++ ){xstr+="<property id=\""+iii+"\">";xstr+=this.rMateChartEncodeXML(value[iii]);xstr+="</property>";}xstr+="</array>";}else{xstr="<object>";for(var propName in value){xstr+="<property id=\""+propName+"\">";xstr+=this.rMateChartEncodeXML(value[propName]);xstr+="</property>";}xstr+="</object>";}return xstr;default:trace("rMateChartEncodeXML unknown type:"+typeof (value));return "<undefined/>";}return "<undefined/>";};this.getNodeText=function(node){if(node.childNodes.length>0){node=node.childNodes[0];}if(node.nodeValue){return node.nodeValue;}else if(node.text){return node.text;}else if(node.textContent){return node.textContent;}return null;};this.rMateChartParseArgNode=function(node){var nM=node.nodeName;switch(nM){case "number":return Number(this.getNodeText(node));case "string":return unescape(this.getNodeText(node));case "undefined":return undefined;case "null":return null;case "true":return true;case "false":return false;case "bool":if(this.getNodeText(node)=="true"){return true;}else{return false;}case "object":var obj={};if(node.childNodes&&node.childNodes.length>0){for(var ii=0;ii<node.childNodes.length;ii++ ){if(node.childNodes[ii].nodeName=="property"){obj[node.childNodes[ii].attributes.getNamedItem("id").value]=this.rMateChartParseArgNode(node.childNodes[ii].childNodes[0]);}}}return obj;case "array":var arr=[];if(node.childNodes&&node.childNodes.length>0){for(var iii=0;iii<node.childNodes.length;iii++ ){if(node.childNodes[iii].nodeName=="property"){arr[iii]=this.rMateChartParseArgNode(node.childNodes[iii].childNodes[0]);}}}return arr;default:trace("rMateChartParseArgNode unknown type:"+nM);}return null;};this.rMateChartParseErrorHandler=function(parser,parseException){trace("rMateChartParseErrorHandler Parse Error: "+parseException.message+" (line: "+parseException.line+", column: "+parseException.column+")");};this.rMateChartDataSetToXml=function(obj){var dataStr="<items>\n";for(var i=0;i<obj.rowcount;i++ ){dataStr+="<item>\n";for(var j=0;j<obj.getColCount();j++ ){if(obj.getColumn(i,j)!=null){dataStr+=" <"+obj.getColID(j)+">"+this.rMateChartXmlEncoder(obj.getColumn(i,j).toString())+"</"+obj.getColID(j)+">\n";}}dataStr+="</item>\n";}dataStr+="</items>";return dataStr;};this.rMateChartDataSetToXmlWithColumn=function(objDs,arrVal){if(arrVal==null){return this.rMateChartDataSetToXml(objDs);}var arrStr=arrVal.split(",");var rtnVal="<items>";for(var i=0;i<objDs.rowcount;i++ ){rtnVal+="<item>";for(var j=0;j<arrStr.length;j++ ){rtnVal+="<"+arrStr[j]+">"+this.rMateChartXmlEncoder(objDs.getColumn(i,arrStr[j]).toString())+"</"+arrStr[j]+">";}rtnVal+="</item>\n";}rtnVal+="</items>";return rtnVal;};this.rMateChartDataSetToArray=function(obj){var arr=[];for(var i=0;i<obj.rowcount;i++ ){var a={};for(var j=0;j<obj.getColCount();j++ ){if(obj.getColumn(i,j)!=null){a[obj.getColID(j)]=this.rMateChartXmlEncoder(obj.getColumn(i,j).toString());}}arr.push(a);}return arr;};this.rMateChartDataSetToArrayWithColumn=function(objDs,arrVal){if(arrVal==null){return this.rMateChartDataSetToXml(objDs);}var arrStr=arrVal.split(",");var arr=[];for(var i=0;i<objDs.rowcount;i++ ){var a={};for(var j=0;j<arrStr.length;j++ ){a[arrStr[j]]=this.rMateChartXmlEncoder(objDs.getColumn(i,arrStr[j]).toString());}arr.push(a);}return arr;};this.rMateChartXmlEncoder=function(str){var ret="";if(str!=null&&str.length>0){ret=str.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;");}return ret;};});this.loadIncludeScript(path);obj=null;};})();